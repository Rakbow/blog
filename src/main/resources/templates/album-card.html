<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Album Card</title>
    <meta charset="utf-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="viewport" content="width=device-width,initial-scale=1.0"/>
    <!-- bootstrap -->
    <!--    <link rel="stylesheet" th:href="@{/assets/bootstrap/css/bootstrap.min.css}">-->
    <!--    <link rel="stylesheet"-->
    <!--          href="https://fonts.googleapis.com/css?family=Montserrat:400,400i,700,700i,600,600i&amp;display=swap">-->
    <!--    <link rel="stylesheet" th:href="@{/assets/fonts/simple-line-icons.min.css}">-->
    <link rel="stylesheet" th:href="@{/css/ajax/libs/baguettebox.js/1.11.1/baguetteBox.min.css}">
    <!--    <link rel="stylesheet" th:href="@{/assets/css/styles.min.css}">-->
    <link rel="stylesheet" th:href="@{/css/index.css}">
    <link rel="stylesheet" th:href="@{/css/iconfont/iconfont.css}">


    <link rel="shortcut icon" th:href="@{/img/favicon.ico}" type="image/x-icon">
    <script th:src="@{/assets/bootstrap/js/bootstrap.min.js}"></script>
    <script th:src="@{/js/ajax/libs/baguettebox.js/1.11.1/baguetteBox.min.js}"></script>

    <!-- PrimeVue -->
    <link th:href="@{/css/primevue/themes/saga-blue/theme.css}" rel="stylesheet" type="text/css"/>
    <link th:href="@{/css/primevue/primevue.min.css}" rel="stylesheet" type="text/css"/>
    <link th:href="@{/css/primeflex/primeflex.min.css}" rel="stylesheet" type="text/css"/>
    <link th:href="@{/css/primeicons/primeicons.css}" rel="stylesheet" type="text/css"/>

    <!-- Dependencies -->
    <script th:src="@{/js/primevue/vue.min.js}" type="text/javascript"></script>
    <script th:src="@{/js/primevue/primevue.min.js}" type="text/javascript"></script>
    <script th:src="@{/js/primevue/vue-router.global.js}"></script>

    <!-- PrimeVue Components -->
    <script th:src="@{/js/primevue/components/dataview.min.js}"></script>
    <script th:src="@{/js/primevue/components/dataviewlayoutoptions.min.js}"></script>
    <script th:src="@{/js/primevue/components/toolbar.min.js}"></script>
    <script th:src="@{/js/primevue/components/tag.min.js}"></script>
    <script th:src="@{/js/primevue/components/card.min.js}"></script>
    <script th:src="@{/js/primevue/components/panel.min.js}"></script>
    <script th:src="@{/js/primevue/components/menubar.min.js}"></script>
    <script th:src="@{/js/primevue/components/avatar.min.js}"></script>
    <script th:src="@{/js/primevue/components/inputtext.min.js}"></script>

    <!-- Axios -->
    <script th:src="@{/js/axios/axios.min.js}"></script>

    <!-- other -->
    <script th:src="@{/js/basic/httpRequest.js}"></script>
    <script th:src="@{/js/basic/basicParam.js}"></script>
    <script th:src="@{/js/basic/dataHandler.js}"></script>
    <script th:src="@{/js/jquery/1.10.2/jquery.min.js}"></script>
</head>
<body>
<div class="nk-container">
    <div class="main">
        <div id="app">
            <!-- 头部 -->
            <header class="sticky-top mb-2" th:insert="~{header :: site_header}"></header>

            <div class="grid card mt-2">
                <div class="col-12 sm:col-12 md:col-6 lg:col-9">
                    <!--                    <p-toolbar class="mb-4">-->
                    <!--                        <template #start>-->
                    <!--                            <p-button label="新增" icon="pi pi-plus" class="p-button-success mr-4"></p-button>-->
                    <!--                            &lt;!&ndash;          <p-button label="删除" icon="pi pi-trash" class="p-button-danger" @click="confirmDeleteSelected" :disabled="!selectedAlbums || !selectedAlbums.length"></p-button>&nbsp;&ndash;&gt;-->
                    <!--                        </template>-->
                    <!--                    </p-toolbar>-->
                    <p-dataview :value="albums" :layout="layout" :paginator="true" :rows="20" :sort-order="sortOrder"
                                :sort-field="sortField">
                        <template #header>
                            <div class="grid grid-nogutter">
                                <div class="col-6" style="text-align: left">
                                    <p-dropdown v-model="sortKey" :options="sortOptions" option-label="label"
                                                placeholder="按发行时间排序"
                                                @change="onSortChange($event)"></p-dropdown>
                                </div>
                                <div class="col-6" style="text-align: right">
                                    <p-dataviewlayoutoptions v-model="layout"></p-dataviewlayoutoptions>
                                </div>
                            </div>
                        </template>
                        <template #grid="slotProps">
                            <div class="col-xl-2 col-lg-3 col-md-4 col-sm-6 col-xs-12 single-card ml-2">
                                <p-card>
                                    <template #header>
                                        <a :href="'http://localhost:8080/db/album/'+ slotProps.data.id">
                                            <div class="cover-img"
                                                 :style="'background-image:url('+ slotProps.data.cover.url+');' ">
                                                <p-tag class="catalog ml-1 mt-1">
                                                    {{slotProps.data.catalogNo?slotProps.data.catalogNo:"N/A"}}
                                                </p-tag>
                                                <div class="absolute releaseDate">
                                                    <span class="text-center" style="color: white">{{slotProps.data.releaseDate}}</span>
                                                </div>
                                            </div>
                                        </a>
                                    </template>
                                    <template #title>
                                        <span class="text-truncate-2 ml-1 mr-1 mt-1 mb-1">
                                            {{slotProps.data.nameJp}}
                                        </span>
                                    </template>
                                    <template #subtitle>
                                        <div class="grid">
                                            <div class="col-8">
                                                <span class="ml-2 text-end" style="color: white">{{slotProps.data.albumFormat.join(" / ")}}</span>
                                            </div>
                                        </div>
                                    </template>
                                    <template #content>
                                        <ul class="list-inline">
                                            <li class="list-inline-item" v-for="product of slotProps.data.products">
                                                <p-tag class="product-tag">{{product.name}}</p-tag>
                                            </li>
                                        </ul>
                                    </template>
                                </p-card>
                            </div>
                        </template>
                    </p-dataview>
                </div>
                <div class="col-12 sm:col-12 md:col-6 lg:col-3">
                    <p-panel>
                        <template #header>
                            <i class="pi iconfont icon-album mr-2" style="font-size: 2rem"></i>
                            <b>最新添加</b>
                        </template>
                        <div class="grid">
                            <span class="smallfont">
                                    <div class="album_infobit_small smallfont ml-0 grid"
                                         v-if="justAddedAlbums.length != 0"
                                         v-for="addAlbum of justAddedAlbums">
                                        <div class="col-3 small-image-div mt-2">
                                            <a :href="'http://localhost:8080/db/album/'+ addAlbum.id ">
                                                <img class="small-image-img" :src="addAlbum.cover.url"
                                                     style="border-radius: 20%;">
                                            </a>
                                        </div>
                                        <div class="col-9">
                                            <ul class="album_infobit_detail">
                                            <li>
                                                <a class="smallfont album-anime"
                                                   :href="'http://localhost:8080/db/album/'+ addAlbum.id ">
                                                    <span class="text-truncate-2" lang="ja">
                                                        {{addAlbum.nameJp}}
                                                    </span>
                                                </a>
                                            </li>
                                            <li>
                                                <span class="smallfont album-anime">
                                                    <b>{{addAlbum.catalogNo}}</b> {{addAlbum.releaseDate}}
                                                </span>
                                            </li>

                                        </ul>
                                        </div>
                                    </div>
                                </span>
                            <br>
                            <b class="rbot"><b></b></b>
                        </div>
                    </p-panel>
                    <br>
                    <p-panel>
                        <template #header>
                            <i class="pi iconfont icon-album mr-2" style="font-size: 2rem"></i>
                            <b>最新编辑</b>
                        </template>
                        <div class="grid">
                            <span class="smallfont">
                                    <div class="album_infobit_small smallfont ml-0 grid"
                                         v-if="justEditedAlbums.length != 0"
                                         v-for="editAlbum of justEditedAlbums">
                                        <div class="col-3 small-image-div mt-2">
                                            <a :href="'http://localhost:8080/db/album/'+ editAlbum.id ">
                                                <img class="small-image-img" :src="editAlbum.cover.url"
                                                     style="border-radius: 20%;">
                                            </a>
                                        </div>
                                        <div class="col-9">
                                            <ul class="album_infobit_detail">
                                            <li>
                                                <a class="smallfont album-anime"
                                                   :href="'http://localhost:8080/db/album/'+ editAlbum.id ">
                                                    <span class="text-truncate-2" lang="ja">
                                                        {{editAlbum.nameJp}}
                                                    </span>
                                                </a>
                                            </li>
                                            <li>
                                                <span class="smallfont album-anime">
                                                    <b>{{editAlbum.catalogNo}}</b> {{editAlbum.releaseDate}}
                                                </span>
                                            </li>

                                        </ul>
                                        </div>
                                    </div>
                                </span>
                            <br>
                            <b class="rbot"><b></b></b>
                        </div>
                    </p-panel>
                    <br>
                    <p-panel>
                        <template #header>
                            <i class="pi iconfont icon-album mr-2" style="font-size: 2rem"></i>
                            <b>浏览排名</b>
                        </template>
                        <div class="grid">
                            <span class="smallfont">
                                <div class="album_infobit_small smallfont ml-0 grid"
                                     v-if="popularAlbums.length != 0"
                                     v-for="(album, index) of popularAlbums">
                                        <div class="col-2 ml-0 mr-0 mt-0 mb-0">
                                            <div class="grid">
                                                <div class="col-12 text-center">
                                                    <b style="font-size: 20px">{{index+1}}</b>
                                                </div>
                                                <div class="col-12">
                                                    <i class="pi pi-eye" style="font-size: 0.5rem"></i>
                                                    {{album.visitNum}}
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-3 small-image-div mt-2">
                                            <a :href="'http://localhost:8080/db/album/'+ album.id ">
                                                <img class="small-image-img" :src="album.cover.url"
                                                     style="border-radius: 20%;">
                                            </a>
                                        </div>
                                        <div class="col-7">
                                            <ul class="album_infobit_detail">
                                            <li>
                                                <a class="smallfont album-anime"
                                                   :href="'http://localhost:8080/db/album/'+ album.id ">
                                                    <span class="text-truncate-2" lang="ja">
                                                        {{album.nameJp}}
                                                    </span>
                                                </a>
                                            </li>
                                            <li>
                                                <span class="smallfont album-anime">
                                                    <b>{{album.catalogNo}}</b> {{album.releaseDate}}
                                                </span>
                                            </li>

                                        </ul>
                                        </div>
                                    </div>
                            </span>
                            <br>
                            <b class="rbot"><b></b></b>
                        </div>
                    </p-panel>
                </div>
            </div>
        </div>
    </div>

    <!-- 尾部 -->
    <!--    <footer th:insert="~{footer :: site_footer}"></footer>-->
</div>
<script type="module" th:inline="javascript">
    const {createApp, onMounted, ref} = Vue;
    const {FilterMatchMode, FilterOperator} = primevue.api;
    const Tooltip = primevue.tooltip;
    const {useToast} = primevue.usetoast;

    const App = {
        setup() {
            onMounted(() => {

            });

            const justEditedAlbums = ref([[${justEditedAlbums}]]);
            const justAddedAlbums = ref([[${justAddedAlbums}]]);
            const popularAlbums = ref([[${popularAlbums}]]);

            const layout = ref('grid');
            const sortKey = ref();
            const sortOrder = ref();
            const sortField = ref();
            const sortOptions = ref([
                {label: '按发售时间正序', value: '!releaseDate'},
                {label: '按发售时间逆序', value: 'releaseDate'},
            ]);

            const albums = ref([[${albums}]]);

            const navbarItems = ref([
                {
                    label: 'Home',
                    icon: 'pi pi-fw pi-home',
                    url: "http://localhost:8080"
                },
                {
                    label: 'DataBase',
                    icon: 'pi pi-fw iconfont icon-database',
                    url: "http://localhost:8080/db"
                },
                {
                    label: 'Album',
                    icon: 'pi pi-fw iconfont icon-24gl-musicAlbum2',
                    items: [
                        {
                            label: 'Album List',
                            icon: 'pi pi-fw pi-list',
                            url: 'http://localhost:8080/db/album/list'
                        },
                        {
                            label: 'Album Card',
                            icon: 'pi pi-fw pi-list',
                            url: 'http://localhost:8080/db/album/card'
                        }
                    ]
                },
                {
                    label: 'Disc',
                    icon: 'pi pi-fw iconfont icon-Video-Disc',
                    items: [
                        {
                            label: 'Develop',
                            icon: 'pi pi-fw pi-wrench'
                        },
                        {
                            label: 'Develop',
                            icon: 'pi pi-fw pi-wrench'
                        }
                    ]
                },
                {
                    label: 'Book',
                    icon: 'pi pi-fw pi-book',
                    items: [
                        {
                            label: 'Book List',
                            icon: 'pi pi-fw pi-book'
                        },
                        {
                            label: 'Develop',
                            icon: 'pi pi-fw pi-wrench'
                        }
                    ]
                }
            ]);

            return {
                justAddedAlbums, justEditedAlbums, popularAlbums,
                navbarItems, albums, layout,
                sortKey, sortOrder, sortField, sortOptions
            }
        },
        components: {
            "p-dataview": primevue.dataview,
            "p-dataviewlayoutoptions": primevue.dataviewlayoutoptions,
            "p-dropdown": primevue.dropdown,
            "p-button": primevue.button,
            "p-toolbar": primevue.toolbar,
            "p-tag": primevue.tag,
            "p-card": primevue.card,
            "p-panel": primevue.panel,
            "p-menubar": primevue.menubar,
            "p-avatar": primevue.avatar,
            "p-inputtext": primevue.inputtext,
        }
    };

    const routes = [{path: "/", component: App}];

    const router = VueRouter.createRouter({
        // history: VueRouter.createWebHashHistory(),
        history: VueRouter.createWebHistory(),
        routes
    });

    createApp(App)
        .use(router)
        .use(primevue.toastservice)
        .use(primevue.config.default)
        .directive('tooltip', Tooltip)
        .mount("#app");
</script>
<style>

    b.rbot {
        background-position: 0 -8px;
    }

    .releaseDate {
        bottom: 0;
        right: 0;
        padding: 5px;
        background-color: rgba(0, 0, 0, .47);
    }

    .single-card {
        position: relative;
        width: 300px;
        height: 500px;
        margin: 5px;
        background-color: #2F364F;
        /*padding: 24px 0px 0px 16px;*/
    }

    .cover-img {
        width: 300px;
        height: 300px;
        position: relative;
        background-repeat: no-repeat;
        background-size: 100% 100%;
        /*top: 50%;*/
        /*left: 50%;*/
        /*transform: translate(-50%, -50%);*/
    }

    .catalog {
        align-items: flex-start;
        justify-content: space-around;
        background: #795548 !important;
        color: #ffffff;
    }

    .text-truncate-2 {
        /*text-overflow: -o-ellipsis-lastline;*/
        overflow: hidden;
        text-overflow: ellipsis;
        display: -webkit-box;
        -webkit-line-clamp: 2;
        line-clamp: 2;
        -webkit-box-orient: vertical;
    }

    .p-card .p-card-body {
        background-color: #2F364F;
    }

    .p-card .p-card-title {
        color: #ffffff;
        font-size: 1.2rem;
        font-weight: 500;
        margin: 0.5rem;
    }

    .p-card .p-card-subtitle {
        margin: 0.5rem;
    }

    .p-card .p-card-content {
        margin-top: 0px;
        margin-bottom: 0px;
    }

    .product-tag {
        align-items: flex-start;
        justify-content: space-around;
        background: #788990 !important;
        color: #ffffff;
    }

    .list-inline {
        padding-left: 0;
        margin-top: 0px;
        margin-bottom: 0px;
        list-style: none
    }

    .list-inline-item {
        margin-top: 0px;
        margin-bottom: 0px;
        display: inline-block
    }

    .smallfont {
        font: 11px verdana, geneva, lucida, 'lucida grande', arial, helvetica, Meiryo, sans-serif;
    }

    .album_infobit_small {
        clear: left;
        height: 76px;
        /* border-top: 1px solid #464A64; */
        /* border-bottom: 1px solid #1B273D; */
        padding: 4px 6px 4px 4px;
        overflow: hidden;
    }

    .small-image-div {
        position: relative;
        width: 60px;
        height: 60px;
    }

    .small-image-img {
        width: 50px;
        position: relative;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
    }

    ul.album_infobit_detail {
        list-style-type: none;
        margin: 6px 0 0 0;
        padding: 0;
        overflow: hidden;
    }

</style>
</body>
</html>